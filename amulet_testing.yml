id: com.github.amulet_map_editor
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
sdk-version: '23.08'
command: python -m amulet_map_editor
metadata:
  name: Amulet Minecraft Editor
  description: A powerful Minecraft world editor.
  icon: com.github.amulet_map_editor/icon.png
  homepage: https://amuletmc.com
  license: MIT
finish-args:
  - '--share=network'
  - '--socket=x11'
  - '--socket=wayland'
  - '--device=all'
  - '--filesystem=home'
modules:
  - name: python3-PyOpenGL
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "PyOpenGL" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_11
        type: file
        url: >-
          https://files.pythonhosted.org/packages/99/48/00e31747821d3fc56faddd00a4725454d1e694a8b67d715cf20f531506a5/PyOpenGL-3.1.7-py3-none-any.whl
        sha256: a6ab19cf290df6101aaf7470843a9c46207789855746399d0af92521a0a92b7a
  - name: python3-pyopengl-accelerate
    buildsystem: simple
    build-commands:
      - pip3 install --verbose --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST}
        "pyopengl-accelerate" --report=pip_report.json --no-build-isolation
    sources:
      - type: file
        url: https://files.pythonhosted.org/packages/93/09/d08b3d07dbd88258276496a47273778f330f5ccf8390cb21b16b29d660de/PyOpenGL-accelerate-3.1.7.tar.gz
        sha256: 2b123621273a939f7fd2ec227541e399f9b5d4e815d69ae0bdb1b6c70a293680
#  - name: xapp-gtk3-module
#    buildsystem: meson
#    sources:
#      - type: git
#        url: 'https://github.com/linuxmint/xapp.git'
#        commit: 17955c925c4b90f12af538a67bc417c62eb1c6d3
#  - name: macros
#    buildsystem: simple
#    build-commands:
#      - autogen.sh
#    sources:
#      - type: git
#        url: 'https://gitlab.freedesktop.org/xorg/util/macros.git'
#        commit: 7ed2b3798c030bd1729b699b446b43aba2ec606e
#  - name: xfont2
#    buildsystem: simple
#    build-commands:
#      - make
#    sources:
#      - &ref_15
#        type: git
#        url: https://gitlab.freedesktop.org/xorg/lib/libxfont.git
#        commit: 2c2e44c94ef17ecd5003a173237b57b315e28d93
#  - name: x11
#    buildsystem: meson
#    build-commands:
#      - meson setup --prefix=${FLATPAK_DEST}
#    sources:
#      - *ref_15
#      - type: git
#        url: 'https://gitlab.freedesktop.org/xorg/xserver.git'
#        #commit: e2e5842444c20ab57cfc74cf0c0cdeb021afbc8a
#        tag: master
  - name: python3-python311
    buildsystem: simple
    sources:
      - type: file
        url: 'https://www.python.org/ftp/python/3.11.9/Python-3.11.9.tgz'
        sha256: e7de3240a8bc2b1e1ba5c81bf943f06861ff494b69fda990ce2722a504c6153d
  - name: python3-versioneer
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "versioneer" --report=pip_report.json
        --no-build-isolation
    sources:
      - type: file
        url: >-
          https://files.pythonhosted.org/packages/b0/79/f0f1ca286b78f6f33c521a36b5cbd5bd697c0d66217d8856f443aeb9dd77/versioneer-0.29-py3-none-any.whl
        sha256: 0f1a137bb5d6811e96a79bb0486798aeae9b9c6efc24b389659cebb0ee396cb9
  - name: python3-xapp
    buildsystem: meson
    sources:
      - type: git
        url: >-
          https://github.com/linuxmint/python3-xapp.git
        commit: e97e119d483b849bd833d7900f76c4ee20af2838
  - name: python3-mutf8
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "mutf8==1.0.6" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_2
        type: file
        url: >-
          https://files.pythonhosted.org/packages/ca/31/3c57313757b3a47dcf32d2a9bad55d913b797efc8814db31bed8a7142396/mutf8-1.0.6.tar.gz
        sha256: 1bbbefb67c2e5a57104750bb04b0912200b57b2fa9841be245279e83859cb346
  - name: python3-numpy
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "numpy==1.26.4" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_3
        type: file
        url: >-
          https://files.pythonhosted.org/packages/65/6e/09db70a523a96d25e115e71cc56a6f9031e7b8cd166c1ac8438307c14058/numpy-1.26.4.tar.gz
        sha256: 2a02aba9ed12e4ac4eb3ea9421c420301a0c6460d9830d74a9df87efa4912010
  - name: python3-setuptools_scm
    buildsystem: simple
    build-commands:
      - pip3 install --verbose --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST}
        "setuptools_scm[toml]>=6.2" --report=pip_report.json --no-build-isolation
    sources:
      - &ref_1
        type: file
        url: https://files.pythonhosted.org/packages/08/aa/cc0199a5f0ad350994d660967a8efb233fe0416e4639146c089643407ce6/packaging-24.1-py3-none-any.whl
        sha256: 5b8f2217dbdbd2f7f384c41c628544e6d52f2d0f53c6d0c3ea61aa5d1d7ff124
      - type: file
        url: https://files.pythonhosted.org/packages/a0/b9/1906bfeb30f2fc13bb39bf7ddb8749784c05faadbd18a21cf141ba37bff2/setuptools_scm-8.1.0-py3-none-any.whl
        sha256: 897a3226a6fd4a6eb2f068745e49733261a21f70b1bb28fce0339feb978d9af3
      - type: file
        url: https://files.pythonhosted.org/packages/97/75/10a9ebee3fd790d20926a90a2547f0bf78f371b2f13aa822c759680ca7b9/tomli-2.0.1-py3-none-any.whl
        sha256: 939de3e7a6161af0c887ef91b7d41a53e7c5a1ca976325f429cb46ea9bc30ecc
      - type: file
        url: https://files.pythonhosted.org/packages/26/9f/ad63fc0248c5379346306f8668cda6e2e2e9c95e01216d2b8ffd9ff037d0/typing_extensions-4.12.2-py3-none-any.whl
        sha256: 04e5ca0351e0f3f85c6853954072df659d0d13fac324d0072316b67d7794700d
  - name: python3-lz4
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "lz4==4.3.3" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_7
        type: file
        url: >-
          https://files.pythonhosted.org/packages/a4/31/ec1259ca8ad11568abaf090a7da719616ca96b60d097ccc5799cd0ff599c/lz4-4.3.3.tar.gz
        sha256: 01fe674ef2889dbb9899d8a67361e0c4a2c833af5aeb37dd505727cf5d2a131e
  - name: python3-packaging
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "packaging==24.1" --report=pip_report.json
        --no-build-isolation
    sources:
      - #*ref_0
  - name: python3-pillow
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "pillow==10.4.0" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_4
        type: file
        url: >-
          https://files.pythonhosted.org/packages/cd/74/ad3d526f3bf7b6d3f408b73fde271ec69dfac8b81341a318ce825f2b3812/pillow-10.4.0.tar.gz
        sha256: 166c1cd4d24309b30d61f79f4a9114b7b2313d7450912277855ff5dfd7cd4a06
  - name: python3-PyMCTranslate
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "PyMCTranslate" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_5
        type: file
        url: >-
          https://files.pythonhosted.org/packages/25/e2/b645189fbdbc4f9cad1db97dfc5b1de230baad9d83dba0f731748bb0fbbd/PyMCTranslate-1.2.27-py3-none-any.whl
        sha256: 724e1fa82dcbcf9289b01fb2cb2ad8ee2f0a987ddda01a766a42ec6aca98769a
      - &ref_6
        type: file
        url: >-
          https://files.pythonhosted.org/packages/00/b9/48aa1754bc30143d7623253ff507986123829e9ae78a266ec34e08c0c544/amulet-nbt-2.1.3.tar.gz
        sha256: a9de4fe068329c7a921f09dd4cec37c25c01ac2abeb4e10000e82e526e36d0fc
      - *ref_2
      - *ref_3
  - name: python3-platformdirs
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "platformdirs==3.11.0" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_8
        type: file
        url: >-
          https://files.pythonhosted.org/packages/56/29/3ec311dc18804409ecf0d2b09caa976f3ae6215559306b5b530004e11156/platformdirs-3.11.0-py3-none-any.whl
        sha256: e9d171d00af68be50e9202731309c4e658fd8bc76f55c11c7dd760d023bda68e
  - name: python3-portalocker
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "portalocker==2.10.1" --report=pip_report.json
        --no-build-isolation
    sources:
      - &ref_9
        type: file
        url: >-
          https://files.pythonhosted.org/packages/9b/fb/a70a4214956182e0d7a9099ab17d50bfcba1056188e9b14f35b9e2b62a0d/portalocker-2.10.1-py3-none-any.whl
        sha256: 53a5984ebc86a025552264b459b46a2086e269b21823cb572f8f28ee759e45bf
  - name: python3-wxPython
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "wxPython==4.2.1" --report=pip_report.json
        --no-build-isolation
    sources:
      - *ref_3
      - *ref_4
      - &ref_13
        type: file
        url: >-
          https://files.pythonhosted.org/packages/aa/64/d749e767a8ce7bdc3d533334e03bb1106fc4e4803d16f931fada9007ee13/wxPython-4.2.1.tar.gz
        sha256: e48de211a6606bf072ec3fa778771d6b746c00b7f4b970eb58728ddf56d13d5c
  - name: python3-amulet-core
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "amulet-core" --report=pip_report.json
        --no-build-isolation
    sources:
      - *ref_5
      - *ref_6
      - &ref_12
        type: file
        url: >-
          https://files.pythonhosted.org/packages/16/df/6ad86c1a64350274a05cf56ecb205e1acea74ea376d7a02c4b34b0251388/amulet_core-1.9.25-py3-none-any.whl
        sha256: a626a09e93112032d8de046cef59b3a87bf02e840930fa7218f5b2caacf29254
      - &ref_10
        type: file
        url: >-
          https://files.pythonhosted.org/packages/8a/69/03882a4a7ed933d1f0c622d93a5b2eef2fa51c4bf8ca1ec84d43b88eb113/amulet_leveldb-1.0.2.tar.gz
        sha256: b3aa511ef71bf6bc6b21e96395bded0f392b1dc093ef58d5535067d80ab41541
      - *ref_7
      - *ref_2
      - *ref_3
      - *ref_8
      - *ref_9
  - name: python3-amulet-leveldb
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "amulet-leveldb" --report=pip_report.json
        --no-build-isolation
    sources:
      - *ref_10
  - name: python3-amulet-map-editor
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "amulet-map-editor" --report=pip_report.json
        --no-build-isolation
    sources:
      - *ref_5
      - *ref_11
      - *ref_6
      - *ref_12
      - *ref_10
      - type: file
        url: >-
          https://files.pythonhosted.org/packages/92/ad/7f808413857992512188eaed55108be7201cf18defcd36e8ed9fe9d9c3fc/amulet_map_editor-0.10.35.tar.gz
        sha256: d9a24afa04fc4be3ca029d5ef1bb394b32497533d4e176e3d742f43edab6319a
      - *ref_7
      - &ref_14
        type: file
        url: >-
          https://files.pythonhosted.org/packages/1e/07/bf65fcbb5f66c0e961ff4233023b6ffc65e69f6996251f5a0f1e94e6e65d/minecraft_resource_pack-1.4.3-py3-none-any.whl
        sha256: 672ff157bdb9ccfcbc445393d2e4603cf0d32e320bbc8e7bb5082e855ff3155f
      - *ref_2
      - *ref_3
      - #*ref_0
      - *ref_4
      - *ref_8
      - *ref_9
      - *ref_13
  - name: python3-amulet-nbt
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "amulet-nbt" --report=pip_report.json
        --no-build-isolation
    sources:
      - *ref_6
      - *ref_2
      - *ref_3
  - name: python3-minecraft-resource-pack
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "minecraft-resource-pack"
        --report=pip_report.json --no-build-isolation
    sources:
      - *ref_6
      - *ref_14
      - *ref_2
      - *ref_3
      - *ref_4
      - *ref_8
  - name: python3-amulet-map-editor
    buildsystem: simple
    build-commands:
      - >-
        pip3 install --verbose --no-index --find-links="file://${PWD}"
        --prefix=${FLATPAK_DEST} "amulet-map-editor" --report=pip_report.json
        --no-build-isolation
    sources:
      - type: git
        url: 'https://github.com/Amulet-Team/Amulet-Map-Editor.git'
        tag: master
      - *ref_5
      - *ref_11
      - *ref_6
      - *ref_12
      - *ref_10
      - *ref_7
      - type: file
        url: >-
          https://files.pythonhosted.org/packages/1e/07/bf65fcbb5f66c0e961ff4233023b6ffc65e69f6996251f5a0f1e94e6e65d/minecraft_resource_pack-1.4.3-py3-none-any.whl
        sha256: 672ff157bdb9ccfcbc445393d2e4603cf0d32e320bbc8e7bb5082e855ff3155f
      - *ref_2
      - *ref_3
      - #*ref_0
      - *ref_4
      - *ref_8
      - *ref_9
      - *ref_13
  - name: amulet-icon
    buildsystem: simple
    sources:
      - type: file
        path: data/icons/amulet.png
name: Amulet Map Editor
finish:
  modules:
    - xapp-gtk3-module
    - python3-python311
#    - x11
  add-extensions:
    - org.freedesktop.Platform.GL
    - org.xapp.xapp-gtk3-module
environment:
  LD_LIBRARY_PATH: /app/lib
  PYTHONPATH: /app/lib/python3.9/site-packages
  PYTHON_VERSION: 3.11.9
  GTK_MODULES: xapp-gtk3-module
  LIBGL_ALWAYS_SOFTWARE: 1
  GDK_BACKEND: wayland

icon: 'data/icons/amulet.png'

desktop:
  name: Amulet Minecraft Editor
  comment: A powerful Minecraft editor
  exec: python -m amulet_map_editor
  icon: amulet
  terminal: true
  type: Application
  categories: [Game, Graphics]
